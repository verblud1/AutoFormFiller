#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Демонстрация новой функциональности: автоматическая подстановка ID таблицы и названия листа
с возможностью проверки и подтверждения пользователем
"""

import sys
import os

# Добавляем путь к директории utils
sys.path.append(os.path.join(os.path.dirname(__file__), '..'))

from utils.google_sheets_handler import get_both_ids_with_confirmation


def main():
    """Демонстрация работы функции с подстановкой и подтверждением данных"""
    
    print("Демонстрация автоматической подстановки и подтверждения данных")
    print("="*60)
    print("Сейчас будет использована сохраненная конфигурация:")
    print("- ID таблицы для 'АСП_Многодетные'")
    print("- Название листа для 'АСП_Многодетные'")
    print()
    
    # Вызываем функцию, которая автоматически подставит сохраненные значения
    # и предложит пользователю проверить и подтвердить их
    spreadsheet_id, sheet_name = get_both_ids_with_confirmation("АСП_Многодетные")
    
    print()
    print("✅ Финальные данные, которые будут использованы:")
    print(f"   ID таблицы: {spreadsheet_id}")
    print(f"   Название листа: {sheet_name}")
    print()
    print("Теперь эти данные могут быть использованы для работы с Google Sheets.")
    

if __name__ == "__main__":
    main()