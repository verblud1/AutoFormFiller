# Архитектура проекта AutoFormFiller

## Обзор

AutoFormFiller - это модульная система для автоматического заполнения форм в базе данных на основе JSON файлов с информацией о семьях. Архитектура проекта построена по принципу разделения ответственности между модулями, обеспечивая гибкость, масштабируемость и легкость сопровождения.

## Общая архитектура

```
┌─────────────────────────────────────────────────────────────────┐
│                        Launcher (main.py)                       │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐    ┌──────────────────────┐               │
│  │  JSON Creator   │    │  Mass Processor      │               │
│  │  (family_creator│    │  (mass_processor)    │               │
│  │  )              │    │                      │               │
│  └─────────────────┘    └──────────────────────┘               │
└─────────────────────────────────────────────────────────────────┘
                              │
        ┌─────────────────────┼─────────────────────┐
        ▼                     ▼                     ▼
┌───────────────┐   ┌──────────────────┐   ┌─────────────────┐
│   Common      │   │     Utils        │   │ External APIs   │
│(gui_components│   │(data_processing, │   │ (Selenium,     │
│ , etc)        │   │ file_utils, etc) │   │ Pandas, etc)   │
└───────────────┘   └──────────────────┘   └─────────────────┘
```

## Модульная структура

### 1. Launcher (main.py)
**Ответственность**: Центральная точка входа в приложение, предоставляет интерфейс выбора режима работы.

**Компоненты**:
- `show_launcher()` - отображение окна выбора режима
- Обработка аргументов командной строки
- Запуск соответствующего компонента

### 2. JSON Creator (family_creator/)
**Ответственность**: Создание, редактирование и управление JSON файлами с данными семей.

**Основные компоненты**:
- `main.py` - точка входа в приложение создателя JSON
- `json_generator.py` - логика генерации и сохранения JSON файлов
- `gui.py` - графический интерфейс создателя

**Подсистемы**:
- Загрузка/сохранение JSON файлов
- Редактирование данных семей
- Автоматическое определение по реестрам
- Валидация данных

### 3. Mass Processor (mass_processor/)
**Ответственность**: Автоматическое заполнение форм в базе данных на основе JSON файлов.

**Основные компоненты**:
- `main.py` - точка входа в приложение массового обработчика
- `core.py` - основная логика обработки
- `processor.py` - обработка данных для автоматизации

**Подсистемы**:
- Автоматизация браузера (Selenium)
- Обработка очереди семей
- Обработка ошибок и ручное вмешательство
- Сохранение скриншотов

### 4. Common (common/)
**Ответственность**: Общие компоненты интерфейса и вспомогательные функции, используемые обоими приложениями.

**Компоненты**:
- `gui_components.py` - базовые GUI компоненты

### 5. Utils (utils/)
**Ответственность**: Утилитарные функции, обеспечивающие согласованную обработку данных в обоих приложениях.

**Компоненты**:
- `data_processing.py` - обработка и очистка данных
- `file_utils.py` - работа с файлами и конфигурацией
- `validation.py` - валидация данных
- `excel_utils.py` - работа с Excel файлами
- `family_processor.py` - обработка данных семей

## Архитектурные паттерны

### 1. Model-View-Controller (MVC)
- **Model**: `json_generator.py`, `processor.py` - бизнес-логика и данные
- **View**: `gui.py` - представление данных пользователю
- **Controller**: `core.py`, `main.py` - логика управления потоком данных

### 2. Single Responsibility Principle (SRP)
Каждый модуль и класс имеет одну четко определенную ответственность:
- `data_processing.py` - только обработка данных
- `file_utils.py` - только работа с файлами
- `validation.py` - только проверка данных

### 3. Dependency Inversion Principle (DIP)
Высокоуровневые модули не зависят от низкоуровневых, оба зависят от абстракций:
- GUI компоненты зависят от абстрактных интерфейсов обработчиков
- Обработчики зависят от абстрактных интерфейсов валидаторов

## Потоки данных

### Создание JSON файла
```
Пользовательский ввод → GUI → Валидация → Обработка данных → JSON Generator → Сохранение
```

### Массовая обработка
```
JSON файл → Валидация → Обработка данных → Автоматизация браузера → Форма в базе данных
```

## Интеграции

### Внешние зависимости
- **Selenium**: Автоматизация браузера для массового обработчика
- **Pandas/OpenPyXL**: Чтение Excel файлов с реестрами
- **CustomTkinter**: Графический интерфейс
- **WebDriver Manager**: Управление драйверами браузера

### Внутренние зависимости
- `utils` используется обоими основными компонентами
- `common` предоставляет общие компоненты GUI
- `family_processor` используется в обоих компонентах для обработки данных

## Безопасность и надежность

### Обработка ошибок
- Централизованная обработка исключений
- Механизмы ручного вмешательства
- Автосохранение данных

### Валидация
- Валидация на уровне ввода данных
- Проверка целостности JSON файлов
- Проверка формата данных перед сохранением

## Масштабируемость

### Горизонтальная масштабируемость
- Возможность запуска нескольких экземпляров обработчика
- Независимые потоки обработки семей

### Вертикальная масштабируемость
- Модульная архитектура позволяет легко добавлять новые функции
- Возможность расширения через плагины

## Тестирование

### Модульное тестирование
- Каждый модуль может быть протестирован независимо
- Четко определенные интерфейсы облегчают тестирование

### Интеграционное тестирование
- Проверка взаимодействия между модулями
- Тестирование потоков данных между компонентами

## Документация

### Внутренняя документация
- Docstrings в каждом модуле и функции
- Комментарии к сложным алгоритмам
- Примеры использования в EXAMPLES.md

### Внешняя документация
- README.md - общее описание проекта
- PROJECT_STRUCTURE.md - структура проекта
- API.md - документация по API
- ARCHITECTURE.md - этот документ