# Сортировка Excel файла по цветам ячеек

## Основные скрипты

### 1. Сортировка семей по цветам (для реестра многодетных семей)

Скрипт `sort_families_by_colors.py` для сортировки семей в Excel файле по цветам заливки с последующей классификацией по статусам:

- **Красный** (`FFFF0000`): не ответили на звонок
- **Желтый** (`FFFFFF00`): занесено в базу данных
- **Зеленый** (`FF00FF00`): занесено в базу данных
- **Серый** (`FFC0C0C0`): сделано, но не занесено в базу данных
- **Белый** (`FFFFFFFF`): еще не сделано
- **Без цвета**: еще не сделано

#### Использование:

```bash
python sort_families_by_colors.py input_file.xlsx
```

С указанием выходного файла:
```bash
python sort_families_by_colors.py input_file.xlsx -o output_file.xlsx
```

#### Результаты:

Скрипт группирует семьи (строки, относящиеся к одной семье определяются по наличию номера в первом столбце) по цвету заливки главной строки семьи и создает отсортированный Excel файл, где семьи сгруппированы по цветам.

### 2. Графический интерфейс (GUI)

Скрипт `gui_color_sorter.py` предоставляет графический интерфейс с возможностью:
- Выбора файла Excel через диалог
- Кнопки "Анализ" для запуска обработки
- Консоли для вывода статистики по цветам и статусам
- Кнопки "Сохранить отсортированный файл" для сохранения результата

#### Использование:

```bash
python gui_color_sorter.py
```

### 3. Общая сортировка ячеек по цветам

Скрипт `utils/color_sorter.py` для общей классификации ячеек Excel файла по цветам заливки.

## Установка зависимостей

```bash
pip install openpyxl pandas customtkinter
```

## Структура проекта

- `sort_families_by_colors.py` - основной скрипт для сортировки семей по цветам
- `gui_color_sorter.py` - графический интерфейс
- `utils/color_sorter.py` - модуль с основной логикой обработки цветов
- `create_test_xlsx.py` - вспомогательный скрипт для создания тестового файла
- `debug_colors.py` - скрипт для отладки цветов в Excel файлах
- `example_usage.py` - пример использования

## Принцип работы

1. Скрипт читает Excel файл и анализирует заливку ячеек
2. Для файла реестра многодетных семей определяет, где начинаются новые семьи (по номеру в первом столбце)
3. Определяет цвет заливки первой строки каждой семьи
4. Группирует семьи по цветам заливки
5. Создает отсортированный Excel файл с семьями, сгруппированными по цветам
6. Выводит статистику по статусам: 
   - Не ответили на звонок (красный)
   - Занесено в базу (желтый/зеленый)
   - Еще не сделано (без заливки/белый)
   - Сделано, но не занесено (серый)
   - Другие цвета